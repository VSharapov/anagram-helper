<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!--<meta http-equiv="refresh" content="5; URL=https://vas.im/anagram-helper/">-->
    <style type="text/css">
      @media (prefers-color-scheme: dark) {
        body {background-color: black; color: white;}
        a {filter: invert(1) brightness(0.5) invert(1);}
      }
    </style>
    <script src="https://cdn.rawgit.com/showdownjs/showdown/1.9.1/dist/showdown.min.js"></script>
    <script>
      var readme = 'README.md'
      var converter = new showdown.Converter();
      html      = converter.makeHtml('loading ' + 'asd' + ' ...');

      function reqListener () {
        html      = converter.makeHtml(this.responseText);
        document.getElementById('readme').innerHTML = html;
        document.title = document.getElementById('readme').children[0].innerHTML;
      }

      function updateAnagram() {
        // Sometimes while editing a <br /> will get inserted, so I clean out the contents:
        phraseIds = ['phrase1', 'phrase2']
        for (i in phraseIds) {
          tagId = phraseIds[i];
          while (document.getElementById(tagId).children.length != 0) {document.getElementById(tagId).removeChild(document.getElementById(tagId).children[0])}
        }
        // Extract and filter
        phrase1 = document.getElementById('phrase1').innerHTML.toUpperCase().replace(/[^0-9a-z]/gi, '');
        phrase2 = document.getElementById('phrase2').innerHTML.toUpperCase().replace(/[^0-9a-z]/gi, '');
        map1 = []; map2 = [];
        for (i in phrase1) {
          map1.push({letter: phrase1[i], mappedTo: -1})
        }
        for (i in phrase2) {
          map2.push({letter: phrase2[i], mappedTo: -1})
        }
        // Map anagrammed characters
        for (i1 in map1) {
          if (map1[i1]['mappedTo'] != -1) {continue;}
          for (i2 in map2) {
            if (map2[i2]['mappedTo'] != -1) {continue;}
            if (map1[i1]['letter'] == map2[i2]['letter']) {
              map2[i2]['mappedTo'] = i1;
              map1[i1]['mappedTo'] = i2;
              console.log(i1, map1[i1], i2, map2[i2])
              break;
            }
          }
        }
        // Display anagram view
        document.getElementById('in1butNot2').innerHTML = "";
        for (i1 in map1) {
          if (map1[i1]['mappedTo'] == -1){
            document.getElementById('in1butNot2').innerHTML += map1[i1]['letter'];
          }
        }
        document.getElementById('in2butNot1').innerHTML = "";
        for (i2 in map2) {
          if (map2[i2]['mappedTo'] == -1){
            document.getElementById('in2butNot1').innerHTML += map2[i2]['letter'];
          }
        }
      }

      function main() {
        var oReq = new XMLHttpRequest();
        oReq.addEventListener("load", reqListener);
        oReq.open("GET", readme);
        oReq.send();
        //
        updateAnagram();
      }
    </script>
	</head>
  <body onload="main()">
    <form oninput="updateAnagram()" onchange="updateAnagram()">
      <h1 contenteditable="true" id="phrase1">clogged toilet</h1><br />
      <!--<input id="phrase1" type="text" value="qwertyuiop" /><br />-->
      <h2 id="in1butNot2"></h1><br />
      <h2 id="in2butNot1"></h1><br />
      <!--<input id="phrase2" type="text" value="typewriter" /><br />-->
      <h1 contenteditable="true" id="phrase2">delete google</h1><br />
    </form>
    <hr />
    <div id="readme"></div>
	</body>
</html>

