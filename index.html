<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!--<meta http-equiv="refresh" content="5; URL=https://vas.im/anagram-helper/">-->
    <style type="text/css">
      @media (prefers-color-scheme: dark) {
        body {background-color: black; color: white;}
        a {filter: invert(1) brightness(0.5) invert(1);}
      }
      .big {
        filter: invert(1) brightness(0.9) invert(1);
        font-size: 200%; font-family: monospace; text-align: center;
        width: 98%;
        max-width: 98%;
        word-break: break-all;
      }
    </style>
    <script src="https://cdn.rawgit.com/showdownjs/showdown/1.9.1/dist/showdown.min.js"></script>
    <script>
      var readme = 'README.md'
      var converter = new showdown.Converter();
      html      = converter.makeHtml('loading ' + 'asd' + ' ...');

      function reqListener () {
        html      = converter.makeHtml(this.responseText);
        document.getElementById('readme').innerHTML = html;
        document.title = document.getElementById('readme').children[0].innerHTML;
      }

      function updateAnagram() {
        // Sometimes while editing a <br /> will get inserted, so I clean out the contents:
        phraseIds = ['phrase1', 'phrase2']
        for (i in phraseIds) {
          tagId = phraseIds[i];
          while (document.getElementById(tagId).children.length != 0) {document.getElementById(tagId).removeChild(document.getElementById(tagId).children[0])}
        }
        // Extract and filter
        phrase1 = document.getElementById('phrase1').value.toUpperCase().replace(/[^0-9a-z]/gi, '');
        phrase2 = document.getElementById('phrase2').value.toUpperCase().replace(/[^0-9a-z]/gi, '');
        map1 = []; map2 = [];
        for (i in phrase1) {
          map1.push({letter: phrase1[i], mappedTo: -1})
        }
        for (i in phrase2) {
          map2.push({letter: phrase2[i], mappedTo: -1})
        }
        // Map anagrammed characters
        for (i1 in map1) {
          if (map1[i1]['mappedTo'] != -1) {continue;}
          for (i2 in map2) {
            if (map2[i2]['mappedTo'] != -1) {continue;}
            if (map1[i1]['letter'] == map2[i2]['letter']) {
              map2[i2]['mappedTo'] = i1;
              map1[i1]['mappedTo'] = i2;
              console.log(i1, map1[i1], i2, map2[i2])
              break;
            }
          }
        }
        // Display anagram view
        sink = "";
        function styleOfNumber(number) {
          if (number != -1) {
            return 'thin and translucent';
          } else {
            return 'bold';
          }
        }
        function styleText(strIn, styleDescription) {
          out = "";
          if (styleDescription == 'bold') {
            out = "<b>" + strIn + "</b>";
          }
          if (styleDescription == 'thin and translucent') {
            out = "<span style=\"opacity: 0.3; font-weight: lighter;\">" + strIn + "</span>";
          }
          return out;
        }
        document.getElementById('in1butNot2').innerHTML = "";
        for (i1 in map1) {
          document.getElementById('in1butNot2').innerHTML += styleText(
            map1[i1]['letter'],
            styleOfNumber(map1[i1]['mappedTo'])
            )
        }
        document.getElementById('in2butNot1').innerHTML = "";
        for (i2 in map2) {
          document.getElementById('in2butNot1').innerHTML += styleText(
            map2[i2]['letter'],
            styleOfNumber(map2[i2]['mappedTo'])
            )
        }
      }

      function main() {
        var oReq = new XMLHttpRequest();
        oReq.addEventListener("load", reqListener);
        oReq.open("GET", readme);
        oReq.send();
        //
        updateAnagram();
      }
    </script>
	</head>
  <body onload="main()">
    <center><form class="big" oninput="updateAnagram()" onchange="updateAnagram()">
      <input class="big" id="phrase1" type="text" value="clogged toilet" /><br />
      <br />
      <!--<h1 contenteditable="true" id="phrase1">clogged toilet</h1><br />-->
      <big>
      <span class="big" id="in1butNot2">asd</span><hr />
      <span class="big" id="in2butNot1">asd</span><br />
      </big>
      <br />
      <input class="big" id="phrase2" type="text" value="delete google" /><br />
      <!--<h1 contenteditable="true" id="phrase2">delete google</h1><br />-->
      </form></center>
    <hr/>
    <div id="readme"></div>
	</body>
</html>

